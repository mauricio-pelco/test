<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs title="Standalone Gadget 2.3"
  description="Attempting to create a standalone JQL gadget" 
  author="Mauricio Munoz" 
  author_email="mauricio.pelco@gmail.com">
    <Optional feature="gadget-directory">
      <Param name="categories">JIRA</Param>
    </Optional>
  </ModulePrefs>
  <Content type="html">
    <![CDATA[
		
		<div id="main" style="display: none">
			hello world!
		</div>
		
		<body>
			<h1 id="result">JavaScript Example</h1>
//			<input type="text" id="userInput" autofocus value = "Enter some text here ..." />
			<input type="submit" value="Submit" onclick="fetchData()" />
		</body>
	
		<script type="text/javascript">
		
//			function displayOutput() {
//				var input = document.getElementById("userInput").value;
//				if (input.length === 0) {
//					alert("Please enter a valid input");
//					return;
//				}
//				document.getElementById("result").innerHTML = "You have entered " + input;
//			}
		
			function showSection(section){
				var el = document.getElementById(section);
				el.style.display = "block";
			}
			
			function showResults(result) {
				showSection('main');
				
				var nameNode = document.createTextNode(result.description);
				var sampleNode = document.createTextNode("here");
				document.getElementById("main").appendChild(document.createElement("br"))
				document.getElementById("main").appendChild(sampleNode);
				document.getElementById("main").appendChild(document.createElement("br"))
				document.getElementById("main").appendChild(nameNode);
				
			}
			
			function fetchData(){
				showSection('main');
				
				var params = {};
				var url = "http://localhost:8080/rest/gadget/1.0/issueTable/jql?jql=";
				url = url + escape("assignee = currentUser() AND resolution = unresolved ORDER BY priority DESC");
				
				params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
				params[gadgets.io.RequestParameters.METHOD] = gadgets.io.MethodType.GET;
				
				var hereNode = document.createTextNode("here");
			    document.getElementById("main").appendChild(document.createElement("br"))
				document.getElementById("main").appendChild(hereNode);
				
				var tabName = gadgets.Tab.getName();
				var hereNode2 = document.createTextNode(tabName);
				document.getElementById("main").appendChild(document.createElement("br"))
				document.getElementById("main").appendChild(hereNode2);
//				gadgets.io.makeRequest(url, call){
//					showResults(response.data);
//				 }
//			
//			
			}
			
//			gadgets.util.registerOnLoadHandler(fetchData);
		</script>
		
		
    ]]>
  </Content>
</Module>