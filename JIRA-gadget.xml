<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs title="DDI Gadget 2.1"
  description="Attempting to create a standalone JQL gadget" 
  author="Mauricio Munoz" 
  author_email="mauricio.pelco@gmail.com">
    <Optional feature="gadget-directory">
      <Param name="categories">JIRA</Param>
    </Optional>
  </ModulePrefs>
  <Content type="html">
    <![CDATA[
	
		<div id="main" style="display: none">
			hello
		</div>
			
		<div class="column-picker-select-wrapper">
			<select id="column-picker-select" class="select">
				<option value="">Select a field...</option>
				<option value="">Option 1</option>
			</select>
			<input id="column-picker-add" type="button" value="Add" class="button">
		</div>
		
		<script type="text/javascript">
		
			function showSection(section){
				var el = document.getElementById(section);
				el.style.display = "block";
			}
			
			function hideSection(section){
				var el - document.getElementById(section);
				el.style.display = "none";
			}
			
			function fetchData(){
			
				var nameNode = document.createTextNode("here");
				document.getElementById('main').appendChild(nameNode);
				document.getElementById('main').appendChild(document.createElement("br"));
				
				showSection('main');
				
				var params = {};
				var url = "http://localhost:8080/rest/gadget/1.0/issueTable/jql?jql=issuetype=Bug";
				//url = url + escape("issuetype=Bug");
				
				params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
				
				gadgets.io.makeRequest(url, response, params);
				
			}
			
			function response(obj) { 
				var bodyNode = document.createElement("div");
				bodyNode.innerHTML = obj.data.table;
				document.getElementById("main").appendChild(bodyNode);
				alert(obj.data);
			};
			
			gadgets.util.registerOnLoadHandler(showSection('main'));
		//	gadgets.util.registerOnLoadHandler(fetchData);
		</script>
		
	
		
    ]]>
  </Content>
</Module>