<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs title="DDI Gadget 2.3"
  description="Attempting to create a standalone JQL gadget" 
  author="Mauricio Munoz" 
  author_email="mauricio.pelco@gmail.com">
    <Optional feature="gadget-directory">
      <Param name="categories">JIRA</Param>
    </Optional>
  </ModulePrefs>
  <Content type="html">
    <![CDATA[
		
		<div id="main" style="display: block">
			DDI NUMBER:
		</div>
	
		<script type="text/javascript">
		
			function showSection(section){
				var el = document.getElementById(section);
				el.style.display = "block";
			}
			
			function fetchData(){
				var params = {};
				var url = "http://localhost:8080/rest/gadget/1.0/issueTable/jql?jql=";
				url = url + escape("issuetype=Bug");
				
				params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
				
				gadgets.io.makeRequest(url, response, params);
				
			}
			
			function response(obj) { 
				var jsondata = obj.data;
				var html = "";
				// Process returned JS object as an associative array
				for (var key in jsondata) {
					var value = jsondata[key];
					html += key + ": ";
					// If 'value' is an array, render its contents as a bulleted list
					if (value instanceof Array)
					{
					html += "<br /><ul>";
					for (var i = 0; i < value.length ; i++)
					{
						html += "<li>"+ jsondata.Hobbies[i] + "</li>";
					}
					html+= "</ul>";
					}  
					// If 'value' isn't an array, just write it out as a string
					else {        
					html += value + "<br />";
					}      
				}               
				document.getElementById('main').innerHTML = html;
			};
			
			gadgets.util.registerOnLoadHandler(fetchData);
		</script>
		
		
    ]]>
  </Content>
</Module>